import{a as R}from"./chunk-3JDA3SAT.js";import{a as U}from"./chunk-24UUDT7J.js";import{a as M}from"./chunk-PJMKHLN3.js";import{a as L}from"./chunk-7LJBHI36.js";import{B as E,D as w,F as m,H as F,I as T,J as k,K as r,L as n,M as _,N as C,O as g,P as a,U as s,V as x,W as D,a as b,aa as I,b as v,c as h,ca as V,ka as $,m as l,n as S,pa as P,r as u,s as f,sa as A,w as y,y as o}from"./chunk-KXOE7I45.js";var j=(i,p)=>p.id,q=i=>["/product/edit",i];function B(i,p){if(i&1){let t=C();r(0,"a",16),_(1,"i",17),n(),r(2,"button",18),g("click",function(){u(t);let c=a().$implicit,d=a();return f(d.confirmDelete(c))}),_(3,"i",19),n()}if(i&2){let t=a().$implicit,e=a();m("routerLink",V(3,q,t.id))("title",e.t("edit")),o(2),m("title",e.t("remove"))}}function z(i,p){if(i&1){let t=C();r(0,"div",5)(1,"div",6)(2,"img",7),g("error",function(c){u(t);let d=a();return f(d.onImageError(c))}),n(),r(3,"div",8)(4,"h5",9),s(5),n(),r(6,"p",10),s(7),n()(),r(8,"div",11)(9,"p",12),s(10),n(),r(11,"div",13)(12,"button",14),g("click",function(){let c=u(t).$implicit,d=a();return f(d.addToCart(c))}),_(13,"i",15),n(),w(14,B,4,5),n()()()()}if(i&2){let t=p.$implicit,e=a();o(2),m("src",t.image,y)("alt",t.name),o(3),x(t.name),o(2),D(" ",t.description.substring(0,100),"... "),o(3),x(e.formatCurrency(t.price)),o(2),m("title",e.t("addToCart")),o(2),F(e.auth.isAdmin()?14:-1)}}var G="http://localhost:3000",et=(()=>{class i{constructor(){this.products=E([]),this.api=l(M),this.auth=l(R),this.cart=l(U),this.i18n=l(A),this.globalState=l(L),this.t=this.i18n.t.bind(this.i18n)}ngOnInit(){this.loadProducts()}loadProducts(){return h(this,null,function*(){try{let t=yield this.api.getProducts();this.products.set(t.map(e=>e.image&&e.image.startsWith("/uploads/")?v(b({},e),{image:`${G}${e.image}`}):e))}catch(t){console.error("Falha ao carregar produtos",t)}})}formatCurrency(t){return new Intl.NumberFormat(this.i18n.locale(),{style:"currency",currency:this.i18n.locale()==="pt"?"BRL":"USD"}).format(t)}addToCart(t){this.cart.addToCart(t)}confirmDelete(t){this.globalState.showModal({title:this.t("confirmAction"),body:this.t("areYouSureDelete"),confirm:()=>h(this,null,function*(){yield this.api.deleteProduct(t.id),this.loadProducts()})})}onImageError(t){t.target.src="https://placehold.co/600x400/cccccc/ffffff?text=Image+Error"}static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275cmp=S({type:i,selectors:[["app-catalog"]],standalone:!0,features:[I],decls:10,vars:0,consts:[[1,"p-5","mb-4","banner","rounded-3"],[1,"container-fluid","py-5"],[1,"display-5","fw-bold"],[1,"col-md-8","fs-4"],[1,"row","g-4"],[1,"col-12","col-sm-6","col-lg-4"],[1,"card","product-card"],[1,"card-img-top",3,"error","src","alt"],[1,"card-body"],[1,"card-title"],[1,"card-text","text-muted","small"],[1,"card-footer","d-flex","justify-content-between","align-items-center"],[1,"price","mb-0"],[1,"d-flex","gap-2"],[1,"btn","btn-success","btn-icon",3,"click","title"],[1,"bi","bi-cart-plus"],[1,"btn","btn-primary","btn-icon",3,"routerLink","title"],[1,"bi","bi-pencil-square"],[1,"btn","btn-danger","btn-icon",3,"click","title"],[1,"bi","bi-trash"]],template:function(e,c){e&1&&(r(0,"div")(1,"div",0)(2,"div",1)(3,"h1",2),s(4,"Rick Produtos e Utilidades"),n(),r(5,"p",3),s(6," Encontre tudo o que precisa, do eletr\xF4nico mais moderno aos itens essenciais para o dia a dia. Qualidade e confian\xE7a em um s\xF3 lugar. "),n()()(),r(7,"div",4),T(8,z,15,7,"div",5,j),n()()),e&2&&(o(8),k(c.products()))},dependencies:[$,P],encapsulation:2,changeDetection:0})}}return i})();export{et as CatalogComponent};
